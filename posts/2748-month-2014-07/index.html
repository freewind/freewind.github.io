
<!DOCTYPE html>
<html>
<head>
    <title>2014-07 月结</title>
    

<meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
<link rel="alternate" type="application/rss+xml" title="Freewind @ Thoughtworks ~ Feed" href="/feed.xml" />

<link href="/assets/rainbow/themes/github.css" rel="stylesheet" type="text/css">
<link rel='stylesheet' href='/assets/css/main.css' type='text/css' media='all' />

<script src="/assets/rainbow/js/rainbow.js"></script>
<script src="/assets/rainbow/js/language/generic.js"></script>
<script src="/assets/rainbow/js/language/python.js"></script>
<script src="/assets/rainbow/js/language/java.js"></script>
<script src="/assets/rainbow/js/language/javascript.js"></script>
<script src="/assets/rainbow/js/language/html.js"></script>
<script src="/assets/rainbow/js/language/css.js"></script>
<script src="/assets/rainbow/js/language/scala.js"></script>
<script src="/assets/rainbow/js/language/shell.js"></script>

</head>
<body>

<h1>
    (2014-08-06) 2014-07 月结
</h1>

    <div>
    <a href="http://findti.com/?r=0379029af20eda86" target="_blank">广告：从今天开始用云梯翻墙</a>
</div>


<hr/>

<div>
    <p>2014年7月，真是超级繁忙的一个月。这个月主要做了这几件事：</p>
<ol>
<li>Scala workshop持续进行中</li>
<li>参加硬件技术大赛，展示了作品"无敌方向键&rdquo;</li>
<li>对项目的scala代码进行了重构</li>
<li>把前端框架AngularJs引入到项目中</li>
</ol>
<h2>Scala workshop</h2>
<p>Scala workshop参与的人越来越少，现在基本上只剩下几个有scala项目的组的人在参加。想想原因应该有这几个：</p>
<ol>
<li>Scala的学习门槛太高，如果没有强烈的学习兴趣或项目压力，基本上难以坚持</li>
<li>组织经验不足，想当然的定出学习计划，到最后无法实施</li>
<li>备课难度高，常常为了准备一节课，需要一整周的业余时间</li>
</ol>
<p>不过好在坚持下来的，都有强大的动力。所以还是要继续坚持下去</p>
<h2>硬件技术大赛</h2>
<p>由西安硬件小组举办的“硬件技术大赛”，终于开始了。我的作品是名为“无敌方向键”，是一个很小的硬件装置，可以放在键盘空格键的旁边，用拇指轻触来向上下左右四个方向移动光标。这里说的“光标”，是编辑文件时一闪一闪的那个竖条，而不是鼠标。</p>
<p>想做这个东西，是因为平时写代码时，虽然已经做到了大多数时候通过快捷键可以让手指不离字母区，但移动光标时，还是不可避免的要让右手离开，向右移动按方向键。当看到西安硬件小组的session里，介绍可以用arduino这种开源的硬件开发板与电脑交互时，我想利用它来实现这个功能。</p>
<p>最开始有多种方案，比如触摸屏、触摸条、轻触开关、滚轮、轨迹球等，但实现过程中，多数因为找不到合适的硬件而放弃，最后将黑莓手机的轨迹球改装了一下。当我们用手指轻触上面的小球时，它会在四条不同的线路中发送脉冲，Arduino通过我们编写的程序发送相应的方向键代码给电脑，就能操作光标的移动。</p>
<h2>对项目的Scala代码进行重构</h2>
<p>新的项目组中，各项目都是用scala做的，其代码存在一个比较大的问题：在一个共用的项目定义了一个abstract的入口类，定义了程序启动时的各种流程以及需要子类提供的配置，其它的项目都将继承并扩展它。</p>
<p>这种做法有很大的问题，因为这个基类实际上已经是一个“考虑不周全的框架”了。子类只能在有限的扩展点上添加自己的代码，而无法改变预定义的流程。详细的问题将另写博客说明。</p>
<p>经过跟客户的沟通，我跟一位有经验的同事一起，对它们进行了构重。我们去掉了共用项目中的子类，把它们分解成一个个独立的组件。在子项目中，程序的流程由子项目决定，只在需要的时候，从共用项目中挑选合适的组件拿过来用。重构之后，代码看起来比以前整洁很多。一位同事说“我看现在的代码，感觉到有一种美感”。</p>
<p>这是我第一次对Scala项目做重构，收获很大。在这个过程中，深刻体会到了Scala类型系统的优势：项目中几乎所有的类都动了，包括很多测试类，但是当我修复了所有的编译错误后，居然一次性跑过了所有的测试，真有点不可思议。</p>
<h2>项目中引入前端框架AngularJS</h2>
<p>项目有越来越多的代码需要由Javascript在前端进行操作了。我们讨论了两种方案：</p>
<ol>
<li>继续使用jQuery、underscore这种工具库操作，不采用框架（如backbone）</li>
<li>采用AngularJS</li>
</ol>
<p>最后决定使用AngularJS。我和另一位同事有过使用这的经验，倾向于它。</p>
<p>但引入前端框架，实际上是引入了整个工具链。各种依赖管理、单元测试和集成测试，这一套东西弄下来，是一条相当长的链子：</p>
<ol>
<li>npm - 各种开发时需要的库的管理</li>
<li>grunt - 构建工具</li>
<li>bower - 页面和测试中需要的库的管理</li>
<li>AnguarJS - 前端框架</li>
<li>Karma - 主要用来跑单元测试</li>
<li>Protactor - 主要用来跑e2e测试</li>
</ol>
<p>为了把这一套跑通，花了大量的精力。为了不耽误其它同事的工作，我必须冲在最前面，把所有遇到的坑都填平。好消息是，基本上所有的坑都填平了，坏消息是我病了一场。</p>
<h2>总结</h2>
<p>繁忙但是非常有收获的一个月</p>

</div>

    
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'freewind'; // required: replace example with your forum shortname
    var disqus_identifier = '2748';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


</body>
    
<script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-54316895-1");
        pageTracker._trackPageview();
    } catch(err) {}
</script>

</html>
